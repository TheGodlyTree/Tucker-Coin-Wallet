<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>TuckCoin</title>
    <style>
        body { font-family: sans-serif; background: #f4f4f9; display: flex; justify-content: center; padding: 50px; }
        .card { background: white; padding: 2rem; border-radius: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); width: 350px; }
        input { width: 100%; padding: 10px; margin: 10px 0; border: 1px solid #ddd; border-radius: 6px; box-sizing: border-box; }
        button { width: 100%; padding: 10px; background: #007bff; color: white; border: none; border-radius: 6px; cursor: pointer; }
        button:hover { background: #0056b3; }
        .balance-display { font-size: 1.5rem; font-weight: bold; color: #28a745; text-align: center; margin: 20px 0; }
        .hidden { display: none; }
        .error { color: #dc3545; font-size: 0.8rem; }
    </style>
</head>
<body>

<div class="card">
    <div id="setup-section">
        <h2>Create Account</h2>
        <input type="text" id="username-input" placeholder="Choose Account Name">
        <button onclick="createAccount()">Start Earning</button>
        <p id="setup-error" class="error"></p>
    </div>

    <div id="wallet-section" class="hidden">
        <h2 id="welcome-msg">Welcome!</h2>
        <div class="balance-display">$<span id="balance-amount">0</span></div>
        
        <hr>
        
        <h3>Transfer Money</h3>
        <input type="text" id="target-user" placeholder="Recipient Name">
        <input type="number" id="transfer-amount" placeholder="Amount">
        <button onclick="transfer()">Send Credits</button>
        <p id="transfer-msg"></p>
        
        <br>
        <button onclick="logout()" style="background:#6c757d">Log Out / Switch User</button>
    </div>
</div>

<script>
    let currentUser = null;

    // Load user data from "Database" (LocalStorage)
    function getDB() {
        return JSON.parse(localStorage.getItem('bank_db')) || {};
    }

    function saveDB(db) {
        localStorage.setItem('bank_db', JSON.stringify(db));
    }

    function createAccount() {
        const name = document.getElementById('username-input').value.trim();
        if (!name) return;

        let db = getDB();
        if (!db[name]) {
            db[name] = { balance: 100.00 }; // New accounts get $100 starter
            saveDB(db);
        }
        
        login(name);
    }

    function login(name) {
        currentUser = name;
        document.getElementById('setup-section').classList.add('hidden');
        document.getElementById('wallet-section').classList.remove('hidden');
        document.getElementById('welcome-msg').innerText = `Hello, ${name}!`;
        updateDisplay();
    }

    function updateDisplay() {
        const db = getDB();
        document.getElementById('balance-amount').innerText = db[currentUser].balance.toFixed(2);
    }

    function transfer() {
        const target = document.getElementById('target-user').value.trim();
        const amount = parseFloat(document.getElementById('transfer-amount').value);
        const msg = document.getElementById('transfer-msg');
        let db = getDB();

        if (!db[target]) {
            msg.innerText = "Error: User does not exist!";
            msg.className = "error";
            return;
        }

        if (amount > 0 && db[currentUser].balance >= amount) {
            db[currentUser].balance -= amount;
            db[target].balance += amount;
            saveDB(db);
            updateDisplay();
            msg.innerText = "Transfer Successful!";
            msg.className = "";
            msg.style.color = "green";
        } else {
            msg.innerText = "Invalid amount or low balance.";
            msg.className = "error";
        }
    }

    function logout() {
        location.reload(); // Quickest way to reset the UI state
    }
</script>

</body>
</html>
